<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Star Wars Run</title>
  <script defer src="/__/firebase/8.6.4/firebase-app.js"></script>
  <script defer src="/__/firebase/8.6.4/firebase-analytics.js"></script>
  <script defer src="/__/firebase/8.6.4/firebase-performance.js"></script>
  <script defer src="/__/firebase/init.js?useEmulator=true"></script>
  <link rel="stylesheet prefetch" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
    integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />

  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/6.6.7/rxjs.umd.min.js"
    integrity="sha512-0/2ebe9lI6BcinFBXFjbBkquDfccT2wP+E48pecciFuGMXPRNdInXZawHiM2NUUVJ4/aKAzyebbvh+CkvRhwTA=="
    crossorigin="anonymous"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.js"
    integrity="sha512-c7SfJeKRl8g7wgL+zMGX78faYVGp+NZVQ587mRLrqeLySX/qHCQOKw/iZ5Pp64DaPjvedixWC/Fe73upnhBaRA=="
    crossorigin="anonymous"></script>
  <script id="card-list-template" type="text/x-handlebars-template">
    <div class="container">
      <div>
        <div class="notification">
          <nav class="pagination" role="navigation" aria-label="pagination">
            {{#if payload.prev }}<a class="pagination-previous">Previous</a>{{/if}}
            <span>Total Count: {{ payload.count }}</span>
            {{#if payload.next }}<a class="pagination-next">Next</a>{{/if}}
          </nav>
        </div>
      </div>
    {{#each payload.results}}
    <div class="card">
      <header class="card-header">
        <p class="card-header-title">
          {{name}}
        </p>
      </header>
      <div class="card-content">
        <div class="content">
            <table>
              <th>Birth Year</th>
              <th>Eye Color</th>
              <th>Hair Color</th>
              <th>Skin color</th>
              <th>Gender</th>
              <tr>
                <td>{{birth_year}}</td>
                <td>{{eye_color}}</td>
                <td>{{hair_color}}</td>
                <td>{{skin_color}}</td>
                <td>{{gender}}</td>
              </tr>
            </table>
      </div>
    </div>
    {{/each}}
    </div>   
  </script>
</head>

<body>
  <main class="container">
    <nav class="navbar" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <a class="navbar-item" href="/">
          <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 64 64"
            style=" fill:#000000;">
            <linearGradient id="E9lyb49nX~HUmdVx4pznLa_69493_gr1" x1="48.25" x2="48.25" y1="23" y2="26"
              gradientUnits="userSpaceOnUse" spreadMethod="reflect">
              <stop offset="0" stop-color="#6dc7ff"></stop>
              <stop offset="1" stop-color="#e6abff"></stop>
            </linearGradient>
            <path fill="url(#E9lyb49nX~HUmdVx4pznLa_69493_gr1)"
              d="M49.044,23H46v3h3.044c0.794,0,1.456-0.6,1.456-1.5C50.5,23.6,49.838,23,49.044,23z"></path>
            <linearGradient id="E9lyb49nX~HUmdVx4pznLb_69493_gr2" x1="39.25" x2="39.25" y1="36" y2="39"
              gradientUnits="userSpaceOnUse" spreadMethod="reflect">
              <stop offset="0" stop-color="#6dc7ff"></stop>
              <stop offset="1" stop-color="#e6abff"></stop>
            </linearGradient>
            <path fill="url(#E9lyb49nX~HUmdVx4pznLb_69493_gr2)"
              d="M40.044,36H37v3h3.044c0.794,0,1.456-0.6,1.456-1.5C41.5,36.6,40.838,36,40.044,36z"></path>
            <linearGradient id="E9lyb49nX~HUmdVx4pznLc_69493_gr3" x1="26.5" x2="26.5" y1="35.4" y2="39"
              gradientUnits="userSpaceOnUse" spreadMethod="reflect">
              <stop offset="0" stop-color="#6dc7ff"></stop>
              <stop offset="1" stop-color="#e6abff"></stop>
            </linearGradient>
            <path fill="url(#E9lyb49nX~HUmdVx4pznLc_69493_gr3)" d="M25 39L28 39 26.5 35.4z"></path>
            <linearGradient id="E9lyb49nX~HUmdVx4pznLd_69493_gr4" x1="35.5" x2="35.5" y1="22.4" y2="26"
              gradientUnits="userSpaceOnUse" spreadMethod="reflect">
              <stop offset="0" stop-color="#6dc7ff"></stop>
              <stop offset="1" stop-color="#e6abff"></stop>
            </linearGradient>
            <path fill="url(#E9lyb49nX~HUmdVx4pznLd_69493_gr4)" d="M34 26L37 26 35.5 22.4z"></path>
            <linearGradient id="E9lyb49nX~HUmdVx4pznLe_69493_gr5" x1="31.5" x2="31.5" y1="19" y2="46"
              gradientUnits="userSpaceOnUse" spreadMethod="reflect">
              <stop offset="0" stop-color="#1a6dff"></stop>
              <stop offset="1" stop-color="#c822ff"></stop>
            </linearGradient>
            <path fill="url(#E9lyb49nX~HUmdVx4pznLe_69493_gr5)"
              d="M58,26h-3.21c0.14-0.48,0.21-0.99,0.21-1.5c0-3.03-2.47-5.5-5.5-5.5H41v5.67L39.11,19H14.3 c-2.45,0-4.3,1.89-4.3,4.4c0,1.04,0.36,1.65,0.53,1.93c0.08,0.14,0.22,0.39,0.39,0.67H5v8l4.28,12h4.34l0.88-1.76L15.38,46h10.41 l0.7-3h0.15l0.69,3H39v-0.55C39.52,45.8,40.16,46,40.8,46l11.157,0c2.455,0,4.546-1.95,4.543-4.405 c-0.001-1.037-0.36-1.646-0.54-1.945L55.53,39H58V26z M7,28h6.581c0.39,0,0.632-0.423,0.429-0.756 c-0.601-0.99-1.598-2.636-1.77-2.954c-0.1-0.17-0.24-0.4-0.24-0.89c0-1.39,0.97-2.4,2.3-2.4h16.896l-0.966,3H26v7h-4v-7h-5.496 c-0.395,0-0.634,0.437-0.421,0.77l1.827,2.85c0.06,0.1,0.29,0.57,0.29,0.98c0,1.35-1.05,2.4-2.4,2.4H7V28z M29.59,26L28,30.93V26 H29.59z M19.62,26.57L19.25,26H20v1.45C19.85,26.98,19.66,26.65,19.62,26.57z M20,29.87V32h-1.41C19.26,31.46,19.75,30.72,20,29.87z M16.62,44l-2.12-4.24L12.38,44h-1.66L7.39,34h2.99L12,37.24L13.62,34h1.76L17,37.24L18.62,34h2.99l-3.33,10H16.62z M28.92,44 l-0.7-3H24.9l-0.7,3h-3.13l3.22-10h4.37l3.33,10H28.92z M32,37.71L30.43,33H32V37.71z M33.22,31h-3.14l3.22-10h4.37L41,31h-3.07 l-0.7-3h-3.31L33.22,31z M36.11,32h-1.07l0.46-2h0.15L36.11,32z M56,37h-3.261c-0.398,0-0.637,0.443-0.417,0.776l1.938,2.934 c0.103,0.175,0.248,0.413,0.24,0.931C54.479,42.956,53.371,44,52.055,44L40.8,44c-0.38,0-0.68-0.18-0.81-0.31 C39.64,43.38,37,40.91,37,40.91V44h-3V34l6.171,0c0.793,0,1.588,0.2,2.245,0.643c1.831,1.235,1.95,3.363,0.994,4.797L42.36,41h7.389 c0.407,0,0.643-0.459,0.407-0.79c-0.76-1.065-2.02-2.83-2.027-2.83c-0.1-0.16-0.23-0.39-0.23-0.88c0-1.38,1.08-2.5,2.4-2.5H56V37z M45.99,37.32c0.12,0.55,0.33,0.92,0.47,1.15c0,0,0.15,0.22,0.37,0.53h-1.04c0.14-0.48,0.21-0.99,0.21-1.5 C46,37.44,45.99,37.38,45.99,37.32z M45.9,36.48c-0.27-1.43-1.1-2.67-2.25-3.48h3.92C46.56,33.82,45.91,35.07,45.9,36.48z M48,32.68 v-0.23c0.06,0.05,0.14,0.08,0.2,0.12C48.14,32.61,48.07,32.64,48,32.68z M56,31h-6.2c-0.38,0-0.68-0.18-0.81-0.31 C48.64,30.38,46,27.91,46,27.91V31h-3V21l6.171,0c0.793,0,1.588,0.2,2.245,0.643c1.831,1.235,1.95,3.363,0.994,4.797L51.36,28H56V31 z">
            </path>
          </svg></a>

        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>

      <div id="navbarBasicExample" class="navbar-menu">
        <div class="navbar-start">

          <a class="navbar-item" href="/about.html">
            About
          </a>
        </div>

        <div class="navbar-end ">
          <div class="navbar-item">
            <input class="input mr-3" id="email-signup" type="emal" placeholder="your@emal.com">
            <div class="buttons">
              <a class="button is-primary">
                <strong>Follow The Journey</strong>
              </a>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <nav class="panel">
      <p class="panel-heading">
        Star Wars Run - Explore the Star Wars lore!
      </p>
      <div class="panel-block">
        <p class="control has-icons-left">
          <input class="input" id="search-input" type="text" placeholder="Search for a Person">
          <span class="icon is-left">
            <i class="fas fa-search" aria-hidden="true"></i>
          </span>
        </p>
      </div>
      <p class="panel-tabs">
      <div class="tabs is-centered">
        <ul>
          <li class="is-active"><span class="icon-text">
              <span class="icon">
                <i class="fas fa-user-friends"></i>
              </span>
              <span>People</span>
            </span>
          </li>
          <li>
            <a>
              <span class="icon is-small"><i class="fas fa-sun" aria-hidden="true"></i></span>
              <span>Planets</span>
            </a>
          </li>
          <li>
            <a>
              <span class="icon is-small"><i class="fas fa-film" aria-hidden="true"></i></span>
              <span>Films</span>
            </a>
          </li>
          <li>
            <a>
              <span class="icon is-small"><i class="far fa-dna" aria-hidden="true"></i></span>
              <span>Speices</span>
            </a>
          </li>
          <li>
            <a>
              <span class="icon is-small"><i class="far fa-space-shuttle" aria-hidden="true"></i></span>
              <span>Starships</span>
            </a>
          </li>
          <li>
            <a>
              <span class="icon is-small"><i class="far fa-truck" aria-hidden="true"></i></span>
              <span>Vehicles</span>
            </a>
          </li>
        </ul>
      </div>
      </p>
    </nav>
    <div id="list-result"></div>
    <footer class="is-size-7">
      <a href="https://icons8.com/icon/21576/star-wars">Star Wars icon by Icons8</a>
    </footer>
  </main>
</body>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    firebase.analytics();
    firebase.performance();
  })
</script>

<script type="module">
  const { tap, map, debounceTime, scan, filter, distinctUntilChanged } = rxjs.operators;
  const { from } = rxjs;

  if (window.Worker) {
    const reduxWorker = new Worker('worker.js', { type: "module" });
    // reduxWorker.postMessage("Skywalker");
    var userSearchInput$ = rxjs.fromEvent(document.getElementById("search-input"), "keyup")
      .pipe(
        map((e) => e.target.value),
        debounceTime(750),
        filter((text) => text.length > 1),
        distinctUntilChanged()
      );

    userSearchInput$.subscribe((data) => {
      reduxWorker.postMessage(data)
    });
    var theScript = document.getElementById('card-list-template');
    var theTemplate = Handlebars.compile(theScript.innerHTML);
    // const search_list_template = Handlebars.compile("<div><p>count: {{payload.count}} </p>{{#each payload.results}}<li>{{name}}</li>{{/each}}");

    reduxWorker.onmessage = (e) => {
      console.log("on message ", e);
      const { payload } = e?.data;
      const { results } = payload;
      console.log("payload", payload);
      console.log("result", results);
      const $search = from(results);
      var output = document.getElementById("list-result");
      output.innerHTML = theTemplate({ payload });
      //output.innerHTML = "Hi";
      var elems = document.querySelectorAll('.collapsible');
      var instances = M.Collapsible.init(elems);

    }
  }
</script>

</html>